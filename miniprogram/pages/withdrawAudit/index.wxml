<view class="container" style="padding: 20rpx; background: #f5f5f5; min-height: 100vh;">
  <!-- 状态筛选栏 -->
  <scroll-view scroll-x class="tab-bar" style="white-space: nowrap; padding: 20rpx 0; background: #fff; border-radius: 16rpx; margin-bottom: 20rpx;">
    <view 
      wx:for="{{statusList}}" wx:key="item"
      data-status="{{item}}"
      bindtap="switchStatus"
      style="display: inline-block; padding: 16rpx 32rpx; border-radius: 40rpx; margin: 0 10rpx; font-size: 28rpx; {{currentStatus === item ? 'background: #1890ff; color: #fff' : 'background: #f2f3f5; color: #333'}}">
      {{item === 'all' ? '全部' : statusMap[item]}}
    </view>
  </scroll-view>

  <!-- 提现记录列表 -->
  <view wx:for="{{recordList}}" wx:key="_id" class="record-card" style="background: #fff; border-radius: 16rpx; padding: 30rpx; margin-bottom: 20rpx;">
    <view style="font-size: 32rpx; font-weight: bold; margin-bottom: 16rpx;">
      提现金额：{{item.amount || 0}} 元
    </view>
    <view style="font-size: 26rpx; color: #666; margin-bottom: 8rpx;">
      团长openid：{{item.leaderOpenid || '未知'}}
    </view>
    <!-- 优化：拆分显示微信昵称 -->
    <view style="font-size: 26rpx; color: #666; margin-bottom: 8rpx;">
      收款微信昵称：{{item.payeeInfo.wechatName || '未填写'}}
    </view>
    <!-- 新增：收款码预览 -->
    <view style="margin-bottom: 16rpx;">
      <view style="font-size: 26rpx; color: #666; margin-bottom: 10rpx;">收款码：</view>
      <view wx:if="{{item.payeeInfo.qrcodeFileID}}" 
            bindtap="previewQrcode" 
            data-qrcode="{{item.payeeInfo.qrcodeFileID}}"
            style="width: 180rpx; height: 180rpx; border: 1rpx solid #eee; border-radius: 8rpx;">
        <image src="{{item.payeeInfo.qrcodeFileID}}" 
               style="width: 100%; height: 100%; object-fit: cover;" 
               mode="widthFix"/>
      </view>
      <view wx:else style="font-size: 24rpx; color: #999; padding: 20rpx 0;">未上传收款码</view>
    </view>
    <!-- 优化：显示格式化后的时间 -->
    <view style="font-size: 26rpx; color: #666; margin-bottom: 8rpx;">
      申请时间：{{item.formatCreateTime}}
    </view>
    <view style="font-size: 26rpx; font-weight: bold; margin-bottom: 20rpx; color: {{item.status === 'pending' ? '#ff7d00' : (item.status === 'success' ? '#07c160' : '#ff4d4f')}}">
      状态：{{statusMap[item.status] || '未知'}}
    </view>

    <!-- 审核中显示操作按钮 -->
    <view wx:if="{{item.status === 'pending'}}" style="display: flex; gap: 20rpx;">
      <button 
        bindtap="auditHandle" data-type="pass" 
        data-id="{{item._id}}" data-leaderopenid="{{item.leaderOpenid}}" data-amount="{{item.amount}}"
        style="flex: 1; background: #07c160; color: #fff; border-radius: 12rpx; font-size: 28rpx;">
        通过打款
      </button>
      <button 
        bindtap="auditHandle" data-type="fail"
        data-id="{{item._id}}" data-leaderopenid="{{item.leaderOpenid}}" data-amount="{{item.amount}}"
        style="flex: 1; background: #ff4d4f; color: #fff; border-radius: 12rpx; font-size: 28rpx;">
        驳回退款
      </button>
    </view>
  </view>

  <!-- 加载/空状态 -->
  <view wx:if="{{loading}}" style="text-align: center; padding: 40rpx; color: #999;">加载中...</view>
  <view wx:if="{{!loading && recordList.length === 0}}" style="text-align: center; padding: 60rpx; color: #999; font-size: 28rpx;">暂无提现记录</view>
</view>