<view class="container" style="padding: 20rpx; background: #f5f5f5; min-height: 100vh;">
  <!-- é€šçŸ¥æ æ§åˆ¶åŒºåŸŸ -->
  <view style="background: white; border-radius: 16rpx; padding: 20rpx; margin-bottom: 20rpx; box-shadow: 0 2rpx 8rpx rgba(0,0,0,0.05);">
    <view style="font-size: {{32 * fontSizeMultiple}}rpx; color: #333; font-weight: 500; margin-bottom: 15rpx;">é€šçŸ¥æ æ§åˆ¶</view>
    <view style="display: flex; align-items: center; margin-bottom: 15rpx;">
      <view style="font-size: {{26 * fontSizeMultiple}}rpx; color: #666; width: 200rpx;">æ˜¯å¦å±•ç¤ºé€šçŸ¥</view>
      <switch checked="{{notice.showNotice}}" bindchange="toggleNotice" style="transform: scale(1.1);"/>
    </view>
    <view style="display: flex; flex-direction: column;">
      <view style="font-size: {{26 * fontSizeMultiple}}rpx; color: #666; margin-bottom: 10rpx;">é€šçŸ¥å†…å®¹</view>
      <input value="{{notice.noticeContent}}" bindinput="updateNoticeContent" style="border: 1px solid #e5e5e5; border-radius: 8rpx; padding: 15rpx; font-size: {{24 * fontSizeMultiple}}rpx;"/>
    </view>
    <button bindtap="saveNoticeConfig" style="background: #1890ff; color: white; border: none; border-radius: 8rpx; font-size: {{26 * fontSizeMultiple}}rpx; padding: 12rpx 0; margin-top: 15rpx;">ä¿å­˜é€šçŸ¥é…ç½®</button>
  </view>

  <!-- ç”¨æˆ·ç®¡ç†åŒºåŸŸ -->
  <view style="background: white; border-radius: 16rpx; padding: 20rpx; margin-bottom: 20rpx; box-shadow: 0 2rpx 8rpx rgba(0,0,0,0.05);">
    <view style="font-size: {{34 * fontSizeMultiple}}rpx; color: #333; font-weight: 500; margin-bottom: 20rpx;">ç”¨æˆ·ç®¡ç†åå°</view>
    
    <!-- ç­›é€‰æŒ‰é’® -->
    <view style="display: flex; gap: 10rpx; flex-wrap: wrap; margin-bottom: 20rpx;">
      <button bindtap="filterUsers" data-type="all" style="flex: 1; background: {{currentFilter === 'all' ? '#1890ff' : '#f5f5f5'}}; color: {{currentFilter === 'all' ? 'white' : '#333'}}; border: none; border-radius: 8rpx; font-size: {{26 * fontSizeMultiple}}rpx;">å…¨éƒ¨ç”¨æˆ·</button>
      <button bindtap="filterUsers" data-type="expired" style="flex: 1; background: {{currentFilter === 'expired' ? '#ff4d4f' : '#f5f5f5'}}; color: {{currentFilter === 'expired' ? 'white' : '#333'}}; border: none; border-radius: 8rpx; font-size: {{26 * fontSizeMultiple}}rpx;">å¤±æ•ˆç”¨æˆ·</button>
      <button bindtap="filterUsers" data-type="trial" style="flex: 1; background: {{currentFilter === 'trial' ? '#ff7d00' : '#f5f5f5'}}; color: {{currentFilter === 'trial' ? 'white' : '#333'}}; border: none; border-radius: 8rpx; font-size: {{26 * fontSizeMultiple}}rpx;">è¯•ç”¨ç”¨æˆ·</button>
      <button bindtap="filterUsers" data-type="formal" style="flex: 1; background: {{currentFilter === 'formal' ? '#07c160' : '#f5f5f5'}}; color: {{currentFilter === 'formal' ? 'white' : '#333'}}; border: none; border-radius: 8rpx; font-size: {{26 * fontSizeMultiple}}rpx;">ä»˜è´¹ç”¨æˆ·</button>
    </view>

    <!-- ç”¨æˆ·è¡¨æ ¼ -->
    <view style="overflow-x: auto;">
      <view style="display: flex; background: #f0f9ff; border-radius: 8rpx 8rpx 0 0; padding: 15rpx 0;">
        <view style="width: 12%; text-align: center; font-size: {{24 * fontSizeMultiple}}rpx; color: #333; font-weight: 500;">åºå·</view>
        <view style="width: 25%; text-align: center; font-size: {{24 * fontSizeMultiple}}rpx; color: #333; font-weight: 500;">ç”¨æˆ·æ˜µç§°</view>
        <view style="width: 20%; text-align: center; font-size: {{24 * fontSizeMultiple}}rpx; color: #333; font-weight: 500;">ç”¨æˆ·ç±»å‹</view>
        <view style="width: 23%; text-align: center; font-size: {{24 * fontSizeMultiple}}rpx; color: #333; font-weight: 500;">æœåŠ¡æœ‰æ•ˆæœŸ</view>
        <view style="width: 20%; text-align: center; font-size: {{24 * fontSizeMultiple}}rpx; color: #333; font-weight: 500;">æ“ä½œ</view>
      </view>

      <!-- ç”¨æˆ·åˆ—è¡¨ -->
      <view wx:for="{{filteredUsers}}" wx:key="_id" style="display: flex; align-items: center; padding: 15rpx 0; border-bottom: 1px solid #f5f5f5; background: white;">
        <view style="width: 12%; text-align: center; font-size: {{22 * fontSizeMultiple}}rpx; color: #666;">{{index + 1}}</view>
        <view style="width: 25%; text-align: center; font-size: {{22 * fontSizeMultiple}}rpx; color: #333;">{{item.name || 'æœªè®¾ç½®'}}</view>
        <view style="width: 20%; text-align: center;">
          <view style="display: inline-block; padding: 4rpx 12rpx; border-radius: 16rpx; font-size: {{20 * fontSizeMultiple}}rpx; color: white; background: {{item.userType === 'expired' ? '#ff4d4f' : (item.userType === 'trial' ? '#ff7d00' : '#07c160')}};">
            {{item.userType === 'expired' ? 'å¤±æ•ˆ' : (item.userType === 'trial' ? 'è¯•ç”¨' : 'ä»˜è´¹')}}
          </view>
        </view>
        <view style="width: 23%; text-align: center; font-size: {{20 * fontSizeMultiple}}rpx; color: #666;">{{item.serviceStartTime}} - {{item.serviceEndTime}}</view>
        <view style="width: 20%; text-align: center; display: flex; flex-direction: column; gap: 8rpx;">
          <!-- æ–°å¢ï¼šæŸ¥çœ‹è®¢å•æŒ‰é’® -->
          <button bindtap="openOrderModal" data-id="{{item._id}}" data-name="{{item.name}}" style="background: #722ed1; color: white; border: none; border-radius: 8rpx; font-size: {{20 * fontSizeMultiple}}rpx; padding: 8rpx 0;">æŸ¥çœ‹è®¢å•</button>
          <input 
            placeholder="è¾“å…¥å¤©æ•°" 
            type="number" 
            bindinput="setExtendDays" 
            data-id="{{item._id}}"
            value="{{extendDaysMap[item._id] || ''}}"
            style="border: 1px solid #e5e5e5; border-radius: 8rpx; padding: 8rpx; font-size: {{20 * fontSizeMultiple}}rpx;"
          />
          <button bindtap="extendService" data-id="{{item._id}}" style="background: #1890ff; color: white; border: none; border-radius: 8rpx; font-size: {{20 * fontSizeMultiple}}rpx; padding: 8rpx 0;">ç¡®è®¤ç»­æœŸ</button>
        </view>
      </view>
    </view>

    <!-- æ— æ•°æ®æç¤º -->
    <view wx:if="{{filteredUsers.length === 0}}" style="text-align: center; padding: 40rpx; font-size: {{26 * fontSizeMultiple}}rpx; color: #999;">
      æš‚æ— ç¬¦åˆæ¡ä»¶çš„ç”¨æˆ·
    </view>
  </view>

  <!-- å›¢é•¿æç°å®¡æ ¸å…¥å£ -->
  <view style="background: white; border-radius: 16rpx; padding: 20rpx; box-shadow: 0 2rpx 8rpx rgba(0,0,0,0.05);">
    <button bindtap="goToWithdrawAudit" style="background: #ff7d00; color: white; border: none; border-radius: 8rpx; font-size: {{28 * fontSizeMultiple}}rpx; padding: 15rpx 0; width: 100%;">
      ğŸ’° å›¢é•¿æç°å®¡æ ¸
    </button>
  </view>

  <!-- æ–°å¢ï¼šè®¢å•å¼¹çª— -->
  <view wx:if="{{showOrderModal}}" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; z-index: 999;">
    <view style="width: 90%; max-width: 800rpx; background: white; border-radius: 16rpx; padding: 20rpx; max-height: 80vh; overflow-y: auto;">
      <!-- å¼¹çª—å¤´éƒ¨ -->
      <view style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20rpx; border-bottom: 1px solid #f5f5f5; padding-bottom: 15rpx;">
        <view style="font-size: {{28 * fontSizeMultiple}}rpx; color: #333; font-weight: 500;">{{currentUserName}} çš„è®¢å•</view>
        <button bindtap="closeOrderModal" style="background: transparent; color: #999; border: none; font-size: {{30 * fontSizeMultiple}}rpx; padding: 0;">Ã—</button>
      </view>

      <!-- è®¢å•æ ‡ç­¾åˆ‡æ¢ -->
      <view style="display: flex; margin-bottom: 15rpx;">
        <button bindtap="switchOrderTab" data-tab="normal" style="flex: 1; background: {{activeOrderTab === 'normal' ? '#1890ff' : '#f5f5f5'}}; color: {{activeOrderTab === 'normal' ? 'white' : '#333'}}; border: none; border-radius: 8rpx 0 0 8rpx; font-size: {{24 * fontSizeMultiple}}rpx;">æ™®é€šè®¢å•</button>
        <button bindtap="switchOrderTab" data-tab="reward" style="flex: 1; background: {{activeOrderTab === 'reward' ? '#722ed1' : '#f5f5f5'}}; color: {{activeOrderTab === 'reward' ? 'white' : '#333'}}; border: none; border-radius: 0 8rpx 8rpx 0; font-size: {{24 * fontSizeMultiple}}rpx;">æ¨å¹¿è®¢å•</button>
      </view>

      <!-- æ™®é€šè®¢å•åˆ—è¡¨ -->
      <view wx:if="{{activeOrderTab === 'normal'}}">
        <view wx:if="{{userOrdersMap[currentUserId] && userOrdersMap[currentUserId].length > 0}}">
          <view wx:for="{{userOrdersMap[currentUserId]}}" wx:key="_id" style="padding: 15rpx; border-bottom: 1px solid #f5f5f5; display: flex; justify-content: space-between; align-items: center;">
            <view style="flex: 1;">
              <view style="font-size: {{22 * fontSizeMultiple}}rpx; color: #333;">è®¢å•ç¼–å·ï¼š{{item.orderNo || 'æ— '}}</view>
              <view style="font-size: {{20 * fontSizeMultiple}}rpx; color: #666; margin-top: 5rpx;">åˆ›å»ºæ—¶é—´ï¼š{{item.formatTime}}</view>
              <view style="font-size: {{20 * fontSizeMultiple}}rpx; color: #666; margin-top: 5rpx;">é‡‘é¢ï¼š{{item.amount || 0}} å…ƒ</view>
            </view>
<button 
  bindtap="deleteNormalOrder" 
  data-order-id="{{item._id}}" 
  data-user-id="{{currentUserId}}" 
  style="background: #ff4d4f; color: white; border: none; border-radius: 4rpx; font-size: {{18 * fontSizeMultiple}}rpx; padding: 2rpx 8rpx;"
>
  åˆ é™¤
</button>
 </view>
        </view>
        <view wx:else style="text-align: center; padding: 40rpx; font-size: {{24 * fontSizeMultiple}}rpx; color: #999;">æš‚æ— æ™®é€šè®¢å•</view>
      </view>

      <!-- æ¨å¹¿è®¢å•åˆ—è¡¨ -->
      <view wx:if="{{activeOrderTab === 'reward'}}">
        <view wx:if="{{userRewardRecordsMap[currentUserId] && userRewardRecordsMap[currentUserId].length > 0}}">
          <view wx:for="{{userRewardRecordsMap[currentUserId]}}" wx:key="_id" style="padding: 15rpx; border-bottom: 1px solid #f5f5f5; display: flex; justify-content: space-between; align-items: center;">
            <view style="flex: 1;">
              <view style="font-size: {{22 * fontSizeMultiple}}rpx; color: #333;">è®¢å•ç¼–å·ï¼š{{item.orderNo || 'æ— '}}</view>
              <view style="font-size: {{20 * fontSizeMultiple}}rpx; color: #666; margin-top: 5rpx;">åˆ›å»ºæ—¶é—´ï¼š{{item.formatTime}}</view>
              <view style="font-size: {{20 * fontSizeMultiple}}rpx; color: #666; margin-top: 5rpx;">ä½£é‡‘ï¼š{{item.rewardAmount || 0}} å…ƒ</view>
            </view>
            <button 
  bindtap="deleteRewardOrder" 
  data-record-id="{{item._id}}" 
  data-user-id="{{currentUserId}}" 
  style="background: #ff4d4f; color: white; border: none; border-radius: 4rpx; font-size: {{18 * fontSizeMultiple}}rpx; padding: 2rpx 8rpx;"
>
  åˆ é™¤</button>
          </view>
        </view>
        <view wx:else style="text-align: center; padding: 40rpx; font-size: {{24 * fontSizeMultiple}}rpx; color: #999;">æš‚æ— æ¨å¹¿è®¢å•</view>
      </view>

      <!-- å…³é—­æŒ‰é’® -->
      <button bindtap="closeOrderModal" style="background: #f5f5f5; color: #333; border: none; border-radius: 8rpx; font-size: {{24 * fontSizeMultiple}}rpx; padding: 12rpx 0; margin-top: 20rpx; width: 100%;">å…³é—­</button>
    </view>
  </view>
</view>