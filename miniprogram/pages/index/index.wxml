<view class="container" style="padding: 20rpx; background: linear-gradient(to bottom, #f0f9ff, #ffffff); min-height: 100vh;">
  <!-- 模式切换按钮（右上角） -->
  <view style="display: flex; justify-content: flex-end; margin-bottom: 20rpx;">
    <button bindtap="showModeSwitchSheet" style="background: #1890ff; color: white; border: none; padding: 12rpx 24rpx; border-radius: 8rpx; font-size: {{24 * fontSizeMultiple}}rpx; width: 200rpx;">
      {{isChildMode ? '切换父母模式' : '切换子女模式'}}
    </button>
  </view>

  <!-- 子女模式顶部提示 -->
  <view wx:if="{{isChildMode}}" style="background: #fff8e1; border-radius: 12rpx; padding: 15rpx; margin-bottom: 25rpx; text-align: center;">
    <text style="font-size: {{26 * fontSizeMultiple}}rpx; color: #ff7d00;">当前为子女模式，可管理父母账号+查看签到记录</text>
  </view>

  <!-- 今日签到（仅父母模式显示） -->
  <view wx:if="{{!isChildMode}}" style="margin-bottom: 25rpx;">
    <view style="font-size: {{32 * fontSizeMultiple}}rpx; color: #333; margin-bottom: 10rpx;">今日签到</view>
    <view style="background: white; border-radius: 12rpx; padding: 12rpx; display: flex; align-items: center; box-shadow: 0 2rpx 8rpx rgba(0,0,0,0.05);">
      <view style="flex: 1; font-size: {{34 * fontSizeMultiple}}rpx; color: {{isSigned ? '#07c160' : '#ff4d4f'}}; font-weight: 500;">
        {{isSigned ? '已签到' : '未签到'}}
      </view>
      <button bindtap="handleSign" disabled="{{isSigned || isTrialExpired}}" 
        style="width: 180rpx; background: {{isSigned || isTrialExpired ? '#ccc' : '#1890ff'}}; color: white; border: none; padding: 12rpx 0; border-radius: 12rpx; font-size: {{26 * fontSizeMultiple}}rpx; box-shadow: 0 4rpx 8rpx rgba(24, 144, 255, 0.3);">
        {{isSigned ? '已完成' : (isTrialExpired ? '试用到期' : '一键签到')}}
      </button>
    </view>
  </view>

  <!-- 子女模式：父母签到记录模块 -->
  <view wx:if="{{isChildMode}}" style="margin-bottom: 25rpx;">
    <view style="font-size: {{32 * fontSizeMultiple}}rpx; color: #333; margin-bottom: 10rpx;">父母签到记录</view>
    <view style="background: white; border-radius: 12rpx; padding: 15rpx; box-shadow: 0 2rpx 8rpx rgba(0,0,0,0.05);">
      <!-- 今日签到状态 -->
      <view style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15rpx; padding-bottom: 15rpx; border-bottom: 1px solid #f5f5f5;">
        <view style="font-size: {{28 * fontSizeMultiple}}rpx; color: #666;">今日签到</view>
        <view style="font-size: {{34 * fontSizeMultiple}}rpx; color: {{parentSignStatus ? '#07c160' : '#ff4d4f'}}; font-weight: 500;">
          {{parentSignStatus ? '已签到' : '未签到'}}
        </view>
      </view>
      <!-- 最近7天签到记录 -->
      <view style="font-size: {{26 * fontSizeMultiple}}rpx; color: #666; margin-bottom: 10rpx;">最近7天签到</view>
      <view style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 10rpx;">
        <view wx:for="{{parentSignHistory}}" wx:key="date" style="text-align: center; flex: 1; min-width: 80rpx;">
          <view style="font-size: {{22 * fontSizeMultiple}}rpx; color: #666;">{{item.date}}</view>
          <view style="width: 40rpx; height: 40rpx; border-radius: 50%; margin: 8rpx auto; display: flex; align-items: center; justify-content: center; background: {{item.isSigned ? '#07c160' : '#f5f5f5'}};">
            <text style="font-size: {{20 * fontSizeMultiple}}rpx; color: {{item.isSigned ? 'white' : '#ccc'}};">{{item.isSigned ? '✓' : '×'}}</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- 天气报告模块（双方模式均显示） -->
  <view style="background: white; border-radius: 16rpx; padding: 20rpx; margin-bottom: 25rpx; box-shadow: 0 2rpx 8rpx rgba(0,0,0,0.05);">
    <view style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15rpx;">
      <view style="font-size: {{30 * fontSizeMultiple}}rpx; color: #333; font-weight: 500;">天气报告</view>
      <view class="weather-tabs">
        <view data-index="0" bindtap="switchWeatherTab" style="padding: 8rpx 15rpx; border-radius: 8rpx; font-size: {{26 * fontSizeMultiple}}rpx; {{currentWeatherTab === 0 ? 'background: #1890ff; color: white;' : 'background: #f5f5f5; color: #333;'}}">今天</view>
        <view data-index="1" bindtap="switchWeatherTab" style="padding: 8rpx 15rpx; border-radius: 8rpx; font-size: {{26 * fontSizeMultiple}}rpx; {{currentWeatherTab === 1 ? 'background: #1890ff; color: white;' : 'background: #f5f5f5; color: #333;'}}">明天</view>
        <view data-index="2" bindtap="switchWeatherTab" style="padding: 8rpx 15rpx; border-radius: 8rpx; font-size: {{26 * fontSizeMultiple}}rpx; {{currentWeatherTab === 2 ? 'background: #1890ff; color: white;' : 'background: #f5f5f5; color: #333;'}}">后天</view>
      </view>
    </view>
    <view style="background: #f5faff; border-radius: 12rpx; padding: 20rpx; height: 80rpx; display: flex; align-items: center; justify-content: space-between;">
      <view style="font-size: {{60 * fontSizeMultiple}}rpx;">{{activeWeatherData.icon}}</view>
      <view style="text-align: center; flex: 1; margin: 0 15rpx;">
        <view style="font-size: {{32 * fontSizeMultiple}}rpx; color: #333; font-weight: bold;">{{activeWeatherData.temp}}</view>
        <view style="font-size: {{26 * fontSizeMultiple}}rpx; color: #666; margin-top: 5rpx;">{{activeWeatherData.desc}}</view>
      </view>
      <button bindtap="openWeatherDetail" style="background: #1890ff; color: white; border: none; padding: 12rpx 20rpx; border-radius: 8rpx; font-size: {{22 * fontSizeMultiple}}rpx; width: 160rpx;">查看详情</button>
    </view>
  </view>

  <!-- 版本信息（双方模式均显示，子女可代付费） -->
  <view style="margin-bottom: 25rpx;">
    <view style="font-size: {{32 * fontSizeMultiple}}rpx; color: #333; margin-bottom: 10rpx;">
      {{isChildMode ? '父母版本信息' : '我的版本'}}
    </view>
    <view style="background: white; border-radius: 12rpx; padding: 12rpx; display: flex; align-items: center; box-shadow: 0 2rpx 8rpx rgba(0,0,0,0.05);">
      <view style="flex: 1; font-size: {{30 * fontSizeMultiple}}rpx; color: #333; font-weight: 500;">
        {{isFormalVersion ? '正式版' : '试用版'}}
      </view>
      <button bindtap="showPayDialog" style="width: 180rpx; background: {{isTrialExpired ? '#ff7d00' : (isFormalVersion ? '#1890ff' : '#ff7d00')}}; color: white; border: none; padding: 12rpx 0; border-radius: 12rpx; font-size: {{26 * fontSizeMultiple}}rpx; box-shadow: 0 4rpx 8rpx {{isTrialExpired ? 'rgba(255, 125, 0, 0.3)' : (isFormalVersion ? 'rgba(24, 144, 255, 0.3)' : 'rgba(255, 125, 0, 0.3)')}};">
        {{isFormalVersion ? '续费' : '升级'}}
      </button>
    </view>
    <view style="margin-top: 10rpx; font-size: {{24 * fontSizeMultiple}}rpx; color: #666; text-align: right;">
      服务有效期：{{serviceStartTime}} - {{serviceEndTime}}
    </view>
  </view>

  <!-- 备注与家庭位置（子女可管理） -->
  <view style="margin-bottom: 25rpx;">
    <view style="font-size: {{32 * fontSizeMultiple}}rpx; color: #333; margin-bottom: 10rpx;">
      {{isChildMode ? '父母备注与家庭位置' : '我的备注'}}
    </view>
    <view style="background: white; border-radius: 12rpx; padding: 12rpx; box-shadow: 0 2rpx 8rpx rgba(0,0,0,0.05);">
      <view style="display: flex; align-items: center; margin-bottom: 15rpx;">
        <input style="flex: 1; padding: 12rpx; border: 1px solid #eee; border-radius: 8rpx; font-size: {{28 * fontSizeMultiple}}rpx; margin-right: 10rpx; border: {{focusUserName ? '2px solid #1890ff' : '1px solid #eee'}};" placeholder="请输入姓名或简称" value="{{userName}}" bindinput="onUserNameInput" bindfocus="()=>{focusUserName=true}" bindblur="()=>{focusUserName=false}" disabled="{{isTrialExpired && !isChildMode}}"/>
        <button bindtap="saveUserName" disabled="{{isTrialExpired && !isChildMode}}" style="width: 180rpx; background: {{(isTrialExpired && !isChildMode) ? '#ccc' : '#1890ff'}}; color: white; border: none; padding: 12rpx 0; border-radius: 12rpx; font-size: {{26 * fontSizeMultiple}}rpx; box-shadow: 0 4rpx 8rpx rgba(24, 144, 255, 0.3);">保存</button>
      </view>
      <view style="display: flex; align-items: center;">
        <view style="flex: 1; font-size: {{28 * fontSizeMultiple}}rpx; color: #666;">{{homeLocation ? '家庭位置已设置' : '未设置家庭位置'}}</view>
        <button bindtap="setHomeLocation" disabled="{{isTrialExpired && !isChildMode}}" style="width: 180rpx; background: {{(isTrialExpired && !isChildMode) ? '#ccc' : '#07c160'}}; color: white; border: none; padding: 12rpx 0; border-radius: 12rpx; font-size: {{26 * fontSizeMultiple}}rpx; box-shadow: 0 4rpx 8rpx rgba(7, 193, 96, 0.3);">设置位置</button>
      </view>
    </view>
  </view>

  <!-- 关怀模式（子女可控制父母端） -->
  <view style="margin-bottom: 25rpx;">
    <view style="font-size: {{32 * fontSizeMultiple}}rpx; color: #333; margin-bottom: 10rpx;">
      {{isChildMode ? '父母关怀模式' : '关怀模式'}}
    </view>
    <view style="background: white; border-radius: 12rpx; padding: 15rpx; box-shadow: 0 2rpx 8rpx rgba(0,0,0,0.05);">
      <view style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15rpx;">
        <view style="font-size: {{28 * fontSizeMultiple}}rpx; color: #333;">开启关怀模式（大字体）</view>
        <switch checked="{{careMode}}" bindchange="onCareModeSwitchChange" disabled="{{isTrialExpired && !isChildMode}}" style="transform: scale(1.1);"/>
      </view>
      <view wx:if="{{careMode}}" style="padding: 15rpx; border-top: 1px solid #f5f5f5;">
        <view style="font-size: {{26 * fontSizeMultiple}}rpx; color: #666; margin-bottom: 10rpx;">字体大小：{{Math.round(fontSizeMultiple * 100)}}%</view>
        <picker mode="selector" range="{{fontOptions}}" range-key="name" value="{{currentFontIndex}}" bindchange="onFontChange" style="width: 100%;">
          <view style="border: 2px solid #1890ff; border-radius: 8rpx; padding: 18rpx; font-size: {{28 * fontSizeMultiple}}rpx; color: #1890ff; background: #f0f9ff;">{{fontOptions[currentFontIndex].name}}（当前）</view>
        </picker>
      </view>
    </view>
  </view>

  <!-- 未签到提醒开关（子女可控制父母端） -->
  <view style="margin-bottom: 25rpx;">
    <view style="font-size: {{32 * fontSizeMultiple}}rpx; color: #333; margin-bottom: 10rpx;">
      {{isChildMode ? '父母未签到提醒' : '未签到提醒'}}
    </view>
    <view style="background: white; border-radius: 12rpx; padding: 15rpx; box-shadow: 0 2rpx 8rpx rgba(0,0,0,0.05);">
      <view style="display: flex; justify-content: space-between; align-items: center;">
        <view style="font-size: {{28 * fontSizeMultiple}}rpx; color: #333;">连续2天未签到发送邮箱提醒</view>
        <switch checked="{{enableRemind}}" bindchange="onRemindSwitchChange" disabled="{{isTrialExpired && !isChildMode}}" style="transform: scale(1.1);"/>
      </view>
    </view>
  </view>

  <!-- 我的联系人（子女可管理父母端） -->
  <view style="margin-bottom: 25rpx;">
    <view style="font-size: {{32 * fontSizeMultiple}}rpx; color: #333; margin-bottom: 10rpx;">
      {{isChildMode ? '父母联系人' : '我的联系人'}}
    </view>
    <view style="background: white; border-radius: 16rpx; box-shadow: 0 2rpx 8rpx rgba(0,0,0,0.05);">
      <view wx:for="{{contactsList}}" wx:key="_id" style="padding: 15rpx; border-bottom: 1px solid #f5f5f5; display: flex; justify-content: space-between; align-items: center;">
        <view style="font-size: {{30 * fontSizeMultiple}}rpx; color: #333; font-weight: 500;">{{item.name}}</view>
        <view style="display: flex; gap: 10rpx; width: 60%;">
          <button bindtap="callPhone" data-phone="{{item.phone}}" style="background: #1890ff; color: white; border: none; padding: 12rpx 0; border-radius: 12rpx; font-size: {{26 * fontSizeMultiple}}rpx; flex: 1; box-shadow: 0 4rpx 8rpx rgba(24, 144, 255, 0.3);">打电话</button>
          <button bindtap="deleteContact" data-id="{{item._id}}" disabled="{{isTrialExpired && !isChildMode}}"
            style="background: {{(isTrialExpired && !isChildMode) ? '#ccc' : '#ff4d4f'}}; color: white; border: none; padding: 12rpx 0; border-radius: 12rpx; font-size: {{26 * fontSizeMultiple}}rpx; flex: 1; box-shadow: 0 4rpx 8rpx rgba(255, 77, 79, 0.3);">
            删除
          </button>
        </view>
      </view>
      <button bindtap="showAddDialog" disabled="{{isTrialExpired && !isChildMode}}"
        style="width: 100%; background: {{(isTrialExpired && !isChildMode) ? '#ccc' : 'linear-gradient(to right, #07c160, #06b358)'}}; color: white; border: none; padding: 18rpx 0; border-radius: 0 0 16rpx 16rpx; font-size: {{30 * fontSizeMultiple}}rpx; box-shadow: 0 4rpx 8rpx rgba(7, 193, 96, 0.3);">
        {{(isTrialExpired && !isChildMode) ? '试用到期' : '添加联系人'}}
      </button>
    </view>
  </view>

  <!-- 提醒邮箱（子女可管理父母端） -->
  <view style="margin-bottom: 25rpx;">
    <view style="font-size: {{32 * fontSizeMultiple}}rpx; color: #333; margin-bottom: 10rpx;">
      {{isChildMode ? '父母提醒邮箱' : '提醒邮箱'}}
    </view>
    <view style="background: white; border-radius: 16rpx; box-shadow: 0 2rpx 8rpx rgba(0,0,0,0.05); overflow: hidden;">
      <view wx:for="{{emailList}}" wx:key="_id" style="padding: 15rpx; border-bottom: 1px solid #f5f5f5; display: flex; justify-content: space-between; align-items: center;">
        <view style="font-size: {{30 * fontSizeMultiple}}rpx; color: #333; font-weight: 500;">{{item.email}}</view>
        <view style="width: 35%;">
          <button bindtap="deleteEmail" data-id="{{item._id}}" disabled="{{isTrialExpired && !isChildMode}}"
            style="background: {{(isTrialExpired && !isChildMode) ? '#ccc' : '#ff4d4f'}}; color: white; border: none; padding: 12rpx 0; border-radius: 12rpx; font-size: {{26 * fontSizeMultiple}}rpx; width: 100%; box-shadow: 0 4rpx 8rpx rgba(255, 77, 79, 0.3);">
            删除
          </button>
        </view>
      </view>
      <button bindtap="showEmailDialog" disabled="{{isTrialExpired && !isChildMode}}"
        style="width: 100%; background: {{(isTrialExpired && !isChildMode) ? '#ccc' : 'linear-gradient(to right, #07c160, #06b358)'}}; color: white; border: none; padding: 18rpx 0; font-size: {{30 * fontSizeMultiple}}rpx; box-shadow: 0 4rpx 8rpx rgba(7, 193, 96, 0.3);">
        {{(isTrialExpired && !isChildMode) ? '试用到期' : '添加提醒邮箱'}}
      </button>
    </view>
  </view>

  <!-- 紧急呼叫（仅父母模式显示） -->
  <view wx:if="{{!isChildMode}}" style="margin-bottom: 25rpx;">
    <view style="font-size: {{32 * fontSizeMultiple}}rpx; color: #333; margin-bottom: 10rpx;">紧急呼叫</view>
    <view style="background: white; border-radius: 12rpx; padding: 15rpx; display: flex; gap: 10rpx; box-shadow: 0 2rpx 8rpx rgba(0,0,0,0.05);">
      <button bindtap="callPhone" data-phone="120" style="background: #ff4d4f; color: white; border: none; padding: 12rpx 15rpx; border-radius: 8rpx; font-size: {{26 * fontSizeMultiple}}rpx; flex: 1;">120 急救中心</button>
      <button bindtap="callPhone" data-phone="110" style="background: #1890ff; color: white; border: none; padding: 12rpx 15rpx; border-radius: 8rpx; font-size: {{26 * fontSizeMultiple}}rpx; flex: 1;">110 报警电话</button>
      <button bindtap="callPhone" data-phone="119" style="background: #ff7d00; color: white; border: none; padding: 12rpx 15rpx; border-radius: 8rpx; font-size: {{26 * fontSizeMultiple}}rpx; flex: 1;">119 火警电话</button>
    </view>
  </view>

  <!-- 紧急工具（仅父母模式显示） -->
  <view wx:if="{{!isChildMode}}" style="margin-bottom: 25rpx;">
    <view style="font-size: {{32 * fontSizeMultiple}}rpx; color: #333; margin-bottom: 10rpx;">紧急工具</view>
    <view style="background: white; border-radius: 12rpx; padding: 15rpx; display: flex; gap: 10rpx; box-shadow: 0 2rpx 8rpx rgba(0,0,0,0.05);">
      <button bindtap="goHome" disabled="{{isTrialExpired}}"
        style="background: {{isTrialExpired ? '#ccc' : '#ff7d00'}}; color: white; border: none; padding: 12rpx 0; border-radius: 12rpx; font-size: {{26 * fontSizeMultiple}}rpx; flex: 1; box-shadow: 0 4rpx 8rpx rgba(255, 125, 0, 0.3);">
        一键回家
      </button>
      <button bindtap="sendLocation" disabled="{{isTrialExpired}}"
        style="background: {{isTrialExpired ? '#ccc' : '#1890ff'}}; color: white; border: none; padding: 12rpx 0; border-radius: 12rpx; font-size: {{26 * fontSizeMultiple}}rpx; flex: 1; box-shadow: 0 4rpx 8rpx rgba(24, 144, 255, 0.3);">
        一键发送定位
      </button>
    </view>
  </view>

  <!-- 弹窗组件（所有模式通用） -->
  <!-- 添加邮箱弹窗 -->
  <view wx:if="{{showEmailDialog}}" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 999; display: flex; align-items: center; justify-content: center;">
    <view style="width: 80%; background: white; border-radius: 16rpx; padding: 30rpx; box-shadow: 0 6rpx 16rpx rgba(0,0,0,0.1);">
      <view style="font-size: {{34 * fontSizeMultiple}}rpx; font-weight: bold; text-align: center; margin-bottom: 30rpx; color: #333;">{{isChildMode ? '添加父母提醒邮箱' : '添加提醒邮箱'}}</view>
      <view style="display: flex; align-items: center; margin-bottom: 30rpx;">
        <view style="width: 100rpx; font-size: {{32 * fontSizeMultiple}}rpx; text-align: right; color: #333;">邮箱</view>
        <input
          placeholder="用于连续未签到时接收提醒邮件"
          value="{{email}}"
          bindinput="emailChange"
          type="email"
          style="font-size: {{32 * fontSizeMultiple}}rpx; flex: 1; border: 1px solid #eee; border-radius: 6rpx; padding: 12rpx; margin-left: 10rpx; border: {{focusEmail ? '2px solid #1890ff' : '1px solid #eee'}};"
          bindfocus="()=>{focusEmail=true}" bindblur="()=>{focusEmail=false}"
          placeholder-style="text-align: left; color: #999; font-size: {{30 * fontSizeMultiple}}rpx;"
        />
      </view>
      <view style="display: flex; gap: 20rpx;">
        <button bindtap="bindEmail" style="flex: 1; background: #07c160; color: white; border: none; padding: 15rpx 0; border-radius: 8rpx; font-size: {{32 * fontSizeMultiple}}rpx; border: none;">保存</button>
        <button bindtap="cancelBindEmail" style="flex: 1; background: #f5f5f5; color: #333; padding: 15rpx 0; border-radius: 8rpx; font-size: {{32 * fontSizeMultiple}}rpx; border: none;">取消</button>
      </view>
    </view>
  </view>

  <!-- 添加联系人弹窗 -->
  <view wx:if="{{showAddDialog}}" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 999; display: flex; align-items: center; justify-content: center;">
    <view style="width: 80%; background: white; border-radius: 16rpx; padding: 30rpx; box-shadow: 0 6rpx 16rpx rgba(0,0,0,0.1);">
      <view style="font-size: {{34 * fontSizeMultiple}}rpx; font-weight: bold; text-align: center; margin-bottom: 30rpx; color: #333;">{{isChildMode ? '添加父母紧急联系人' : '添加紧急联系人'}}</view>
      <input
        placeholder="请输入姓名"
        value="{{contactForm.name}}"
        bindinput="onFormChange"
        data-key="name"
        style="font-size: {{32 * fontSizeMultiple}}rpx; margin-bottom: 20rpx; border: 1px solid #eee; border-radius: 6rpx; padding: 12rpx; border: {{focusContactName ? '2px solid #1890ff' : '1px solid #eee'}};"
        bindfocus="()=>{focusContactName=true}" bindblur="()=>{focusContactName=false}"
        placeholder-style="font-size: {{30 * fontSizeMultiple}}rpx; color: #999;"
      />
      <input
        placeholder="请输入手机号"
        value="{{contactForm.phone}}"
        bindinput="onFormChange"
        data-key="phone"
        type="number"
        maxlength="11"
        style="font-size: {{32 * fontSizeMultiple}}rpx; margin-bottom: 30rpx; border: 1px solid #eee; border-radius: 6rpx; padding: 12rpx; border: {{focusContactPhone ? '2px solid #1890ff' : '1px solid #eee'}};"
        bindfocus="()=>{focusContactPhone=true}" bindblur="()=>{focusContactPhone=false}"
        placeholder-style="font-size: {{30 * fontSizeMultiple}}rpx; color: #999;"
      />
      <view style="display: flex; gap: 20rpx;">
        <button bindtap="onConfirmAddContact" style="flex: 1; background: #07c160; color: white; border: none; padding: 15rpx 0; border-radius: 8rpx; font-size: {{32 * fontSizeMultiple}}rpx; border: none;">保存</button>
        <button bindtap="onCancelAddContact" style="flex: 1; background: #f5f5f5; color: #333; padding: 15rpx 0; border-radius: 8rpx; font-size: {{32 * fontSizeMultiple}}rpx; border: none;">取消</button>
      </view>
    </view>
  </view>

  <!-- 支付弹窗 -->
  <view wx:if="{{showPayDialog}}" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 999; display: flex; align-items: center; justify-content: center;">
    <view style="width: 80%; background: white; border-radius: 16rpx; padding: 30rpx; box-shadow: 0 6rpx 16rpx rgba(0,0,0,0.1);">
      <view style="font-size: {{34 * fontSizeMultiple}}rpx; font-weight: bold; text-align: center; margin-bottom: 30rpx; color: #333;">{{isChildMode ? '为父母升级/续费' : (isFormalVersion ? '续费会员' : '升级正式版')}}</view>
      <view style="font-size: {{26 * fontSizeMultiple}}rpx; color: #666; text-align: center; margin-bottom: 20rpx;">
        {{isFormalVersion ? '选择续费时长' : '试用到期后，升级正式版即可继续使用全部功能'}}
      </view>
      <view style="display: flex; gap: 20rpx; margin-bottom: 30rpx;">
        <button bindtap="choosePayType" data-type="month" style="flex: 1; background: #f5f5f5; color: #333; padding: 15rpx 0; border-radius: 8rpx; font-size: {{28 * fontSizeMultiple}}rpx; border: none;">月付<br/>3元/月</button>
        <button bindtap="choosePayType" data-type="year" style="flex: 1; background: #ff7d00; color: white; padding: 15rpx 0; border-radius: 8rpx; font-size: {{28 * fontSizeMultiple}}rpx; border: none;">年付<br/>20元/年</button>
      </view>
      <button bindtap="closePayDialog" style="width: 100%; background: #f5f5f5; color: #333; padding: 15rpx 0; border-radius: 8rpx; font-size: {{28 * fontSizeMultiple}}rpx; border: none;">取消</button>
    </view>
  </view>

  <!-- 天气详情弹窗 -->
  <view wx:if="{{showWeatherDetail}}" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 1000; display: flex; align-items: center; justify-content: center;">
    <view style="background: white; border-radius: 16rpx; padding: 30rpx; width: 85%; max-height: 70vh; overflow-y: auto;">
      <view style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20rpx;">
        <view style="font-size: {{32 * fontSizeMultiple}}rpx; font-weight: 500;">未来3天天气详情</view>
        <button bindtap="closeWeatherDetail" style="font-size: {{28 * fontSizeMultiple}}rpx; color: #ff4d4f;">关闭</button>
      </view>
      <view wx:for="{{weatherList}}" wx:key="date" style="padding: 15rpx 0; border-bottom: 1px solid #f5f5f5; display: flex; justify-content: space-between; align-items: center;">
        <view style="font-size: {{28 * fontSizeMultiple}}rpx; color: #333;">{{item.date}}</view>
        <view style="font-size: {{28 * fontSizeMultiple}}rpx; color: #666;">{{item.weather}}</view>
        <view style="font-size: {{28 * fontSizeMultiple}}rpx; color: #1890ff; font-weight: bold;">{{item.tempMin}}~{{item.tempMax}}°C</view>
      </view>
    </view>
  </view>

  <!-- 模式切换弹窗 -->
  <view wx:if="{{showModeSheet}}" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 999; display: flex; align-items: center; justify-content: center;">
    <view style="width: 80%; background: white; border-radius: 16rpx; padding: 30rpx;">
      <view style="font-size: {{32 * fontSizeMultiple}}rpx; font-weight: 500; text-align: center; margin-bottom: 30rpx;">{{!isChildMode ? '切换至子女模式' : '切换至父母模式'}}</view>
      <view wx:if="{{!isChildMode}}" style="margin-bottom: 30rpx;">
        <view style="font-size: {{22 * fontSizeMultiple}}rpx; color: #666; margin-bottom: 8rpx; text-align: left;">父母账号绑定码（6位数字）</view>
        <input placeholder="请输入父母账号绑定码" value="{{bindCode}}" bindinput="onBindCodeInput" style="font-size: {{28 * fontSizeMultiple}}rpx; border: 1px solid #eee; border-radius: 8rpx; padding: 12rpx; border: {{focusBindCode ? '2px solid #1890ff' : '1px solid #eee'}};" bindfocus="()=>{focusBindCode=true}" bindblur="()=>{focusBindCode=false}"/>
      </view>
      <view style="display: flex; gap: 20rpx;">
        <button bindtap="confirmModeSwitch" style="flex: 1; background: #1890ff; color: white; border: none; padding: 15rpx 0; border-radius: 8rpx; font-size: {{28 * fontSizeMultiple}}rpx;">确认</button>
        <button bindtap="cancelModeSwitch" style="flex: 1; background: #f5f5f5; color: #333; border: none; padding: 15rpx 0; border-radius: 8rpx; font-size: {{28 * fontSizeMultiple}}rpx;">取消</button>
      </view>
    </view>
  </view>
</view>