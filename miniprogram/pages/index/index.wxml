<view class="container">
  <!-- 签到区域 -->
  <van-cell-group title="今日签到" title-style="font-size: 36rpx;">
    <van-cell 
      value="{{isSigned ? '已签到' : '未签到'}}"
      value-style="font-size: 34rpx;"
    >
      <van-button
        slot="right-icon"
        type="{{isSigned ? 'default' : 'primary'}}"
        bindtap="handleSign"
        disabled="{{isSigned}}"
        size="large"
        custom-style="font-size: 34rpx; padding: 0 20rpx;"
      >
        {{isSigned ? '已完成' : '一键签到'}}
      </van-button>
    </van-cell>
  </van-cell-group>

  <!-- 紧急拨号区域 -->
  <van-cell-group title="紧急呼叫" title-style="font-size: 36rpx; margin-top: 20rpx;">
    <van-cell 
      title="120 急救中心" 
      bindtap="callPhone" 
      data-phone="120"
      title-style="font-size: 34rpx; color: #f5222d;"
    />
    <van-cell 
      title="110 报警电话" 
      bindtap="callPhone" 
      data-phone="110"
      title-style="font-size: 34rpx; color: #f5222d;"
    />
    <van-cell 
      title="119 火警电话" 
      bindtap="callPhone" 
      data-phone="119"
      title-style="font-size: 34rpx; color: #f5222d;"
    />
  </van-cell-group>

  <!-- 自定义联系人区域 -->
  <van-cell-group title="我的联系人" title-style="font-size: 36rpx; margin-top: 20rpx;">
    <van-cell wx:for="{{contactsList}}" wx:key="_id" title="{{item.name}}" title-style="font-size: 34rpx;">
      <van-button 
        slot="right-icon" 
        size="large" 
        bindtap="callPhone" 
        data-phone="{{item.phone}}"
        custom-style="font-size: 30rpx; margin-right: 10rpx;"
      >
        打电话
      </van-button>
      <van-button 
        slot="right-icon" 
        size="large" 
        type="danger" 
        bindtap="deleteContact" 
        data-id="{{item._id}}"
        custom-style="font-size: 30rpx;"
      >
        删除
      </van-button>
    </van-cell>
    <van-button 
      type="primary" 
      bindtap="showAddDialog" 
      style="margin: 10px;"
      size="large"
      custom-style="font-size: 32rpx;"
    >
      添加联系人
    </van-button>
  </van-cell-group>

  <!-- 多邮箱展示区域（和联系人样式一致） -->
  <van-cell-group title="提醒邮箱" title-style="font-size: 36rpx; margin-top: 20rpx;">
    <!-- 遍历展示所有邮箱 -->
    <van-cell wx:for="{{emailList}}" wx:key="_id" title="邮箱" value="{{item.email}}" value-style="font-size: 34rpx;">
      <van-button 
        slot="right-icon" 
        size="large" 
        type="danger" 
        bindtap="deleteEmail" 
        data-id="{{item._id}}"
        custom-style="font-size: 30rpx;"
      >
        删除
      </van-button>
    </van-cell>
    <!-- 未添加邮箱时的提示 -->
    <van-cell wx:if="{{emailList.length == 0}}" title="邮箱" value="未添加任何邮箱" value-style="font-size: 34rpx; color: #999;" />
    <!-- 添加邮箱按钮 -->
    <van-button 
      type="default" 
      bindtap="showEmailDialog" 
      style="margin: 10px;"
      size="large"
      custom-style="font-size: 32rpx;"
    >
      添加提醒邮箱
    </van-button>
  </van-cell-group>

  <!-- 邮箱添加弹窗（原生固定层） -->
  <view wx:if="{{showEmailDialog}}" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 999; display: flex; align-items: center; justify-content: center;">
    <view style="width: 80%; background: white; border-radius: 16rpx; padding: 30rpx;">
      <view style="font-size: 34rpx; font-weight: bold; text-align: center; margin-bottom: 30rpx;">添加提醒邮箱</view>
      
      <view style="display: flex; align-items: center; margin-bottom: 30rpx;">
  <view style="width: 100rpx; font-size: 32rpx; text-align: right;">邮箱</view>
  <van-field
    placeholder="用于连续未签到时接收提醒邮件"
    value="{{email}}"
    bind:input="emailChange"
    type="email"
    custom-style="font-size: 32rpx; flex: 1; border: none; padding-left: 10px;"
    placeholder-style="text-align: left;"
  />
</view>

      <view style="display: flex; gap: 20rpx;">
        <button bindtap="bindEmail" style="flex: 1; background: #07c160; color: white; padding: 15rpx 0; border-radius: 8rpx; font-size: 32rpx;">保存</button>
        <button bindtap="cancelBindEmail" style="flex: 1; background: #f5f5f5; color: #333; padding: 15rpx 0; border-radius: 8rpx; font-size: 32rpx;">取消</button>
      </view>
    </view>
  </view>

  <!-- 添加联系人弹窗（原生固定层） -->
  <view wx:if="{{showAddDialog}}" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 999; display: flex; align-items: center; justify-content: center;">
    <view style="width: 80%; background: white; border-radius: 16rpx; padding: 30rpx;">
      <view style="font-size: 34rpx; font-weight: bold; text-align: center; margin-bottom: 30rpx;">添加紧急联系人</view>
      
      <van-field
        label="联系人姓名"
        placeholder="请输入姓名"
        value="{{contactForm.name}}"
        bind:input="onFormChange" 
        data-key="name"
        custom-style="font-size: 32rpx; margin-bottom: 20rpx;"
      />
      <van-field
        label="手机号"
        placeholder="请输入手机号"
        value="{{contactForm.phone}}"
        bind:input="onFormChange"  
        data-key="phone"
        type="number"
        maxlength="11"
        custom-style="font-size: 32rpx; margin-bottom: 30rpx;"
      />

      <view style="display: flex; gap: 20rpx;">
        <button bindtap="onConfirmAddContact" style="flex: 1; background: #07c160; color: white; padding: 15rpx 0; border-radius: 8rpx; font-size: 32rpx;">保存</button>
        <button bindtap="onCancelAddContact" style="flex: 1; background: #f5f5f5; color: #333; padding: 15rpx 0; border-radius: 8rpx; font-size: 32rpx;">取消</button>
      </view>
    </view>
  </view>
</view>